import{d as x,u as y,M as k,P as z,b as E,r as m,f as S,q as L,K as N,o as P,c as f,a as i,s as w,z as R,j as c,i as B,a6 as M,bT as C,bU as F,az as I,aA as q,bV as O}from"./CwABAOlJ.js";const T={class:"main-container text-main flex justify-center items-center gap-4"},V={key:0,class:"inline-block h-8 w-8 animate-spin rounded-full border-2 border-solid border-current border-r-transparent align-[-0.125em] motion-reduce:animate-[spin_1.5s_linear_infinite]",role:"status"},G=x({__name:"[provider]",setup(j){const{t:h,te:_}=y(),u=k(),d=z(),v=E(),l=u.query.code,t=u.params.provider,r=m(null),n=m(!1),p=S(()=>r.value&&L(r.value.message,{t:h,te:_}).message),g=N().public.APP_FLAGS.deviceLimitNewFlow,s=e=>{window.opener&&window.opener.postMessage(e,window.opener.location)},a=e=>{if(!window.opener){e.code&&e.code==="device_limit_exceeded"&&(g?(v.logout(),d.push({path:"/auth/login/",query:{deviceNoLongerAllowedError:"true"}})):q(e.token,e.provider)),r.value=e;return}s({error:JSON.stringify(e)})},b=e=>{if(O(e,t),!window.opener){d.push("/");return}s({success:!0})};return P(async()=>{if(n.value=!0,!l||!t){const e=new Error("Invalid authorization code or provider");a(e);return}try{const{access_token:e}=await C(l);if(window.opener){s({access_token:e});return}const o=F(e,t);I.signSSO(o).then(b).catch(a)}catch(e){a(e)}finally{n.value=!1}}),(e,o)=>{const A=M;return i(),f("div",T,[c(n)?(i(),f("div",V,[...o[0]||(o[0]=[B("span",{class:"!absolute !-m-px !h-px !w-px !overflow-hidden !whitespace-nowrap !border-0 !p-0 ![clip:rect(0,0,0,0)]"},null,-1)])])):w("",!0),c(p)?(i(),R(A,{key:1,type:"danger",text:c(p)},null,8,["text"])):w("",!0)])}}});export{G as default};
//# sourceMappingURL=BOO8XyvO.js.map
