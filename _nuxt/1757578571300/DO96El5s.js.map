{"version":3,"file":"DO96El5s.js","sources":["../../../../app/pages/account/devices.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport useAsync from \"~/composables/use-async\";\nimport DeviceAPI from \"~/services/device\";\nimport useUserStore from \"~/stores/user\";\nimport formatDate from \"~/utils/format-date\";\n\nconst { locale } = useI18n();\nconst { t } = useI18n();\nconst router = useRouter();\nconst userStore = useUserStore();\nconst onSuccess = () => {\n  if (userStore.isAuthenticated)\n    DeviceAPI.checkCurrent().catch(() => onDeviceLimitError());\n};\nconst getFormattedDate = (date: Date): string => formatDate(date, \"PPPP\", locale.value as TAvailableLocale);\n\nconst { loading, error, run: deleteDeviceById } = useAsync(DeviceAPI.delete, { onSuccess });\n\nfunction onDeviceLimitError() {\n  userStore.logout();\n  router.push({ path: \"/auth/login/\", query: { deviceNoLongerAllowedError: \"true\" } });\n}\n</script>\n\n<template>\n  <div>\n    <CardDevice\n      v-for=\"device in userStore.devices\"\n      :key=\"device.id\"\n      class=\"mb-4\"\n      :title=\"device.deviceName\"\n      :type=\"device.deviceType\"\n      :active=\"device.isCurrent\"\n      :date=\"getFormattedDate(device.addedAt)\"\n      :disabled=\"loading\"\n      @delete=\"deleteDeviceById(device.id)\"\n    />\n\n    <BaseAlert v-if=\"error\" type=\"danger\" class=\"mt-6\" :text=\"t(`errors.${error}`)\" />\n  </div>\n</template>\n"],"names":["locale","useI18n","t","router","useRouter","userStore","useUserStore","onSuccess","DeviceAPI","onDeviceLimitError","getFormattedDate","date","formatDate","loading","error","deleteDeviceById","useAsync","_createElementBlock","_openBlock","_Fragment","_renderList","_unref","device","_createBlock","_component_CardDevice","$event","_component_BaseAlert"],"mappings":"8PAMA,KAAM,CAAE,OAAAA,CAAA,EAAWC,EAAA,EACb,CAAE,EAAAC,CAAA,EAAMD,EAAA,EACRE,EAASC,EAAA,EACTC,EAAYC,EAAA,EACZC,EAAY,IAAM,CAClBF,EAAU,iBACZG,EAAU,aAAA,EAAe,MAAM,IAAMC,GAAoB,CAC7D,EACMC,EAAoBC,GAAuBC,EAAWD,EAAM,OAAQX,EAAO,KAAyB,EAEpG,CAAE,QAAAa,EAAS,MAAAC,EAAO,IAAKC,CAAA,EAAqBC,EAASR,EAAU,OAAQ,CAAE,UAAAD,EAAW,EAE1F,SAASE,GAAqB,CAC5BJ,EAAU,OAAA,EACVF,EAAO,KAAK,CAAE,KAAM,eAAgB,MAAO,CAAE,2BAA4B,MAAA,EAAU,CACrF,wCAIEc,EAcM,MAAA,KAAA,EAbJC,EAAA,EAAA,EAAAD,EAUEE,EAAA,KAAAC,EATiBC,EAAAhB,CAAA,EAAU,QAApBiB,QADTC,EAUEC,EAAA,CARC,IAAKF,EAAO,GACb,MAAM,OACL,MAAOA,EAAO,WACd,KAAMA,EAAO,WACb,OAAQA,EAAO,UACf,KAAMZ,EAAiBY,EAAO,OAAO,EACrC,SAAUD,EAAAR,CAAA,EACV,SAAMY,GAAEJ,EAAAN,CAAA,EAAiBO,EAAO,EAAE,CAAA,yEAGpBD,EAAAP,CAAA,OAAjBS,EAAkFG,EAAA,OAA1D,KAAK,SAAS,MAAM,OAAQ,KAAML,EAAAnB,CAAA,EAAC,UAAWmB,EAAAP,CAAA,CAAK,EAAA,CAAA"}