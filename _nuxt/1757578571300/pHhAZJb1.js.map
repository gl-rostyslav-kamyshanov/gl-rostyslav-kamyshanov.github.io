{"version":3,"file":"pHhAZJb1.js","sources":["../../../../app/components/Auth/Form.vue","../../../../app/pages/auth/sign-up/index.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport V from \"~/utils/validate\";\n\nconst props = defineProps<{\n  title?: string;\n  disabled?: boolean;\n  submitLabel?: string;\n}>();\n\nconst { t } = useI18n();\n\nconst emit = defineEmits<{\n  (e: \"submit\", data: Pick<IRequestPayloadSignUp, \"email\" | \"display_name\" | \"password\">): void;\n}>();\n\nconst formData = reactive({\n  email: \"\",\n  fullName: \"\",\n  password: \"\",\n});\ntype State = typeof formData;\n\nfunction validate(data: State): IFormError[] {\n  const errs: IFormError[] = [];\n  const state = unref(data);\n\n  if (!V.required(state.fullName)) {\n    errs.push({ path: \"fullName\", message: t(\"errors.field_is_required\") });\n  }\n\n  if (!V.required(state.email)) {\n    errs.push({ path: \"email\", message: t(\"errors.field_is_required\") });\n  }\n  else if (!V.email(state.email)) {\n    errs.push({ path: \"email\", message: t(\"errors.invalid_email\") });\n  }\n\n  if (!V.required(state.password)) {\n    errs.push({ path: \"password\", message: t(\"errors.field_is_required\") });\n  }\n  else if (!V.min(state.password, { length: 8 })) {\n    errs.push({ path: \"password\", message: t(\"errors.invalid_password\") });\n  }\n\n  return errs;\n}\n\nfunction onSubmit() {\n  const payload = {\n    email: formData.email,\n    display_name: formData.fullName.replace(/\\s+/g, \" \").trim(),\n    password: formData.password,\n  };\n\n  emit(\"submit\", payload);\n}\n</script>\n\n<template>\n  <UForm :state=\"formData\" :validate=\"validate\" @submit=\"onSubmit\">\n    <div class=\"flex flex-col gap-2 sm:gap-6\">\n      <UFormGroup\n        :label=\"t('labels.fullName')\"\n        required\n        name=\"fullName\"\n      >\n        <BaseInput\n          v-model=\"formData.fullName\"\n          :disabled=\"props.disabled\"\n          name=\"fullName\"\n          :placeholder=\"t('labels.full_name_placeholder')\"\n          maxlength=\"100\"\n        />\n      </UFormGroup>\n\n      <UFormGroup\n        :label=\"t('labels.email')\"\n        name=\"email\"\n        required\n      >\n        <BaseInput\n          v-model=\"formData.email\"\n          :disabled=\"props.disabled\"\n          name=\"email\"\n          :placeholder=\"t('labels.email_placeholder')\"\n          autocomplete=\"email\"\n        />\n      </UFormGroup>\n\n      <UFormGroup\n        :label=\"t('labels.password')\"\n        required\n        name=\"password\"\n      >\n        <BaseInput\n          v-model=\"formData.password\"\n          :disabled=\"props.disabled\"\n          :placeholder=\"t('labels.min_8_characters')\"\n          name=\"password\"\n          autocomplete=\"new-password\"\n          sensitive\n        />\n      </UFormGroup>\n      <BaseButton\n        :disabled=\"props.disabled\"\n        class=\"font-bold\"\n        name=\"signup\"\n        full-width\n      >\n        {{ t(\"labels.sign_up\") }}\n      </BaseButton>\n    </div>\n  </UForm>\n</template>\n","<script setup lang=\"ts\">\nimport { breakpointsTailwind, useBreakpoints } from \"@vueuse/core\";\nimport useAsync from \"~/composables/use-async\";\nimport { SEGMENT_TRACK_EVENTS } from \"~/constants/segment\";\nimport AuthAPI from \"~/services/auth\";\nimport getErrorLocalePathMessage from \"~/utils/locale\";\n\nconst toaster = useToast();\nconst router = useRouter();\nconst { t, te } = useI18n();\nconst segment = useSegment();\nconst runtimeConfig = useRuntimeConfig().public;\n\nconst formFields = runtimeConfig.APP_CUSTOMER.form_fields;\nconst hasFollowing = runtimeConfig.APP_CUSTOMER.enable_signup_onboarding_follow;\nconst hasPersonalizationFields = formFields.enable_gender\n|| formFields.enable_city\n|| formFields.enable_country\n|| formFields.enable_date_of_birth\n|| formFields.enable_phone\n|| formFields.enable_postal_code\n|| formFields.enable_gender\n|| formFields.enable_my_club;\n\nconst {\n  loading: providerLoading,\n  run: executeProviderLogin,\n} = useAsync(AuthAPI.signinWithProvider, { onSuccess, onError });\nconst { loading: signUpLoading, run: signup } = useAsync(AuthAPI.signup, { onSuccess, onError });\n\nconst loading = computed(() => signUpLoading.value || providerLoading.value);\n\nfunction onSuccess() {\n  let path = \"/\";\n\n  if (hasPersonalizationFields) {\n    path = \"/auth/sign-up/personalization\";\n  }\n  else if (runtimeConfig.APP_FLAGS.hasPayments && runtimeConfig.APP_CUSTOMER.enable_signup_onboarding_payment) {\n    path = \"/auth/sign-up/subscription/\";\n  }\n  else if (hasFollowing) {\n    path = runtimeConfig.APP_CUSTOMER.enable_leagues_view\n      ? \"/auth/sign-up/following/league\"\n      : \"/auth/sign-up/following/category\";\n  }\n\n  router.push({ path });\n};\n\nfunction onError(error: Error) {\n  const { message } = getErrorLocalePathMessage(error.message, { t, te });\n  return toaster.error(message);\n}\n\nfunction onSubmit(data: Pick<IRequestPayloadSignUp, \"email\" | \"display_name\" | \"password\">) {\n  return signup(data);\n}\n\nconst breakpoints = useBreakpoints(breakpointsTailwind);\nconst sm = breakpoints.greaterOrEqual(\"sm\");\n\nonMounted(() => segment.track(SEGMENT_TRACK_EVENTS.SIGN_UP_STARTED));\n\nuseHead({ title: t(\"labels.sign_up\") });\ndefinePageMeta({ layout: \"auth\" });\n</script>\n\n<template>\n  <AuthHeader with-locale mode=\"sign-in\" :fixed=\"!sm\" :absolute=\"sm\" transparent class=\"my-2 sm:my-0\" />\n\n  <BaseMain>\n    <div class=\"flex flex-col items-center justify-center h-screen sm:pt-0 px-4 sm:px-0\">\n      <div class=\"w-full max-w-[25rem]\">\n        <div class=\"flex flex-col text-center sm:text-left gap-3\">\n          <h1 class=\"text-heading-1-bold\">\n            {{ t(\"labels.sign_up\") }}\n          </h1>\n          <p class=\" text-xs text-secondary\">\n            {{ t(\"pages.auth_sign_up.enter_your_details_below\") }}\n          </p>\n        </div>\n\n        <AuthForm\n          class=\"mt-8\"\n          :disabled=\"loading\"\n          @submit=\"onSubmit\"\n        />\n\n        <AuthProviderButtons\n          :disabled=\"providerLoading\"\n          @click-provider=\"executeProviderLogin\"\n        />\n      </div>\n      <AuthTerms class=\"text-center\" />\n    </div>\n  </BaseMain>\n</template>\n"],"names":["props","__props","t","useI18n","emit","__emit","formData","reactive","validate","data","errs","state","unref","V","onSubmit","payload","_createBlock","_component_UForm","_unref","_createElementVNode","_hoisted_1","_createVNode","_component_UFormGroup","_component_BaseInput","_cache","$event","_component_BaseButton","toaster","useToast","router","useRouter","te","segment","useSegment","runtimeConfig","useRuntimeConfig","formFields","hasFollowing","hasPersonalizationFields","providerLoading","executeProviderLogin","useAsync","AuthAPI","onSuccess","onError","signUpLoading","signup","loading","computed","path","error","message","getErrorLocalePathMessage","sm","useBreakpoints","breakpointsTailwind","onMounted","SEGMENT_TRACK_EVENTS","useHead","_component_AuthHeader","_component_BaseMain","_hoisted_2","_hoisted_3","_hoisted_4","_toDisplayString","_hoisted_5","_component_AuthForm","_component_AuthProviderButtons","_component_AuthTerms"],"mappings":"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"}