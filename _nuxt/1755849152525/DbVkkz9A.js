import{_ as L,a as $}from"./DmSNc9U_.js";import{d as B,c as x,a as m,J as F,bM as I,u as H,M as D,P as K,bN as J,K as G,r as v,e as R,bk as h,o as Q,bB as W,h as y,w as T,i as n,s as E,z as X,j as r,t as g,_ as Y,m as Z,F as tt}from"./CMXPbp7C.js";import{B as U}from"./xsw4Ry_I.js";import"./DMkqKyVO.js";import"./CBjFyxbN.js";import"./DDzd6toU.js";import"./DCz_l1Zb.js";import"./JTdTQlDe.js";import"./C2ORbUZG.js";import"./QL_oFunT.js";import"./BQ4KkwTu.js";import"./Dy0jkx8y.js";import"./CXKQkZz-.js";import"./cCBaP_no.js";import"./B3Kb2PV6.js";import"./C0fPgoYu.js";import"./CCR8b9b1.js";import"./BHoeYgzR.js";import"./CGyH9wK9.js";import"./Cgl7qRLf.js";import"./c0PQ5L_F.js";import"./CJcOdyz3.js";import"./BW4JKS41.js";import"./Cw0F3zGg.js";const et=["width","height"],ot=B({__name:"Blade2",props:{size:{default:40}},setup(i){const t=i;return(s,a)=>(m(),x("svg",{xmlns:"http://www.w3.org/2000/svg",width:t.size,height:t.size,viewBox:"0 0 24 24"},a[0]||(a[0]=[F('<g><rect width="2" height="5" x="11" y="1" fill="currentColor" opacity=".14"></rect><rect width="2" height="5" x="11" y="1" fill="currentColor" opacity=".29" transform="rotate(30 12 12)"></rect><rect width="2" height="5" x="11" y="1" fill="currentColor" opacity=".43" transform="rotate(60 12 12)"></rect><rect width="2" height="5" x="11" y="1" fill="currentColor" opacity=".57" transform="rotate(90 12 12)"></rect><rect width="2" height="5" x="11" y="1" fill="currentColor" opacity=".71" transform="rotate(120 12 12)"></rect><rect width="2" height="5" x="11" y="1" fill="currentColor" opacity=".86" transform="rotate(150 12 12)"></rect><rect width="2" height="5" x="11" y="1" fill="currentColor" transform="rotate(180 12 12)"></rect><animateTransform attributeName="transform" calcMode="discrete" dur="0.75s" repeatCount="indefinite" type="rotate" values="0 12 12;30 12 12;60 12 12;90 12 12;120 12 12;150 12 12;180 12 12;210 12 12;240 12 12;270 12 12;300 12 12;330 12 12;360 12 12"></animateTransform></g>',1)]),8,et))}}),rt=Object.assign(ot,{__name:"IconSpinnerBlade2"});function nt(i,t){i&&i.on(I.USER_PURCHASE_STATUS,({status:s})=>{s==="APPROVED"?t?.onSuccess?.():t?.onError?.(new Error("Payment Failed!"))})}const st={class:"flex px-4 items-center justify-center flex-col h-full"},it={class:"w-full max-w-[400px]"},at={class:"flex flex-col justify-center items-center"},ct={class:"flex flex-col justify-center items-center gap-6"},lt={key:0,class:"flex justify-center items-center size-16 bg-[var(--base-card-bgColor)] rounded-full"},ut={class:"flex flex-col justify-center items-center gap-4"},mt={class:"text-3xl font-bold"},_t={class:"text-center text-[var(--base-secondary-color)] font-medium"},jt=B({__name:"processing",setup(i){const{t}=H(),s=D(),a=K(),w=J(),l=G().public,A=!l.APP_CUSTOMER.enable_async_payment_flow,k=Math.abs(l.APP_CUSTOMER.payment_timeout)*1e3,u=l.APP_CUSTOMER.success_payment_redirect_url,S=l.APP_CUSTOMER.subscription_id,o=s.query.productId,_=s.query.redirectURL,M=s.query.title,p=u&&S===o,f=v(!0),d=v(null),{run:b}=R(U.verifyTransaction,{onSuccess:P,onError:C}),{run:N}=R(U.confirmProcessingPayment);function P(){if(o&&h.remove(`transactionId_${o}`),p){const e=new URL(u);return window.location.href=e.toString()}if(f.value=!1,u&&S===o){const e=new URL(u);return window.location.href=e.toString()}a.push({path:"/payment/success/",query:{title:M,productId:o,redirectURL:_}})}function C(){o&&h.remove(`transactionId_${o}`),f.value=!1,a.push({path:"/payment/failure/",query:{productId:o,redirectURL:_}})}async function O(){const e=h.get(`transactionId_${o}`);if(A)return b(e);e&&await N(e),await Promise.race([new Promise(c=>{nt(w,{onSuccess:()=>{P(),c()},onError:()=>{C(),c()}})}),new Promise(c=>{d.value=setTimeout(c,k)})]),e&&b(e)}return Q(O),W(()=>{w?.off(I.USER_PURCHASE_STATUS),d.value&&clearTimeout(d.value)}),(e,c)=>{const j=L,V=rt,z=Y,q=$;return m(),x(tt,null,[y(j,{transparent:"",absolute:""}),y(q,{class:"!h-[calc(100%-25px)]"},{default:T(()=>[n("div",st,[n("div",it,[n("div",at,[n("div",ct,[r(f)?(m(),x("div",lt,[y(V,{size:24})])):E("",!0),n("div",ut,[n("h1",mt,g(r(t)("pages.account_billing.payment_in_progress")),1),n("p",_t,g(r(p)?r(t)("pages.account_billing.payment_in_progress_message_2"):r(t)("pages.account_billing.payment_in_progress_message")),1)]),r(p)?E("",!0):(m(),X(z,{key:1,name:"subscribe",type:"primary",class:"font-bold",tag:"nuxt-link",to:{path:r(_)||"/"}},{default:T(()=>[Z(g(r(t)("labels.back_to_site")),1)]),_:1},8,["to"]))])])])])]),_:1})],64)}}});export{jt as default};
