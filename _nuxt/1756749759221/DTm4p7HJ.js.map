{"version":3,"file":"DTm4p7HJ.js","sources":["../../../../app/services/identityItems.ts","../../../../app/queries/identityItems.ts","../../../../app/pages/category/[mainId]/sub-category/[subId].vue"],"sourcesContent":["import useRequest from \"~/composables/use-request\";\nimport { formatIdentityItem, formatPaginatedResponseItems, formatRequestOptions } from \"~/services/format\";\n\nexport interface IIdentityItemsRequestOptions extends IRequestPaginatedOptions {\n  identityId?: string;\n}\n\nexport const IdentityItemsAPI = {\n  load(options: IIdentityItemsRequestOptions): Promise<IPaginatedResponse<IModelIdentityItem>> {\n    const { request } = useRequest();\n    const params: IRequestPaginatedParams & { filters?: IRequestParamFilter } = formatRequestOptions(options);\n\n    if (options.identityId) {\n      params.sort = `media_parent_order.${options.identityId}`;\n      params.filters = { identityId: options.identityId, media_type: \"identity_item\" };\n    }\n\n    return request\n      .post<IPaginatedResponse<IResponseIdentity>>(\"/api/identity/list\", { body: params })\n      .then(response => formatPaginatedResponseItems(response, formatIdentityItem));\n  },\n\n  async loadById(subCategoryId: string): Promise<IModelIdentityItem> {\n    const { request } = useRequest();\n\n    return await request\n      .get<IContentResponse<IResponseIdentityItem>>(`/api/identity/get_by_id/id/${subCategoryId}`)\n      .then(async (res) => {\n        return formatIdentityItem(res.content);\n      });\n  },\n};\n","import type { Ref } from \"vue\";\nimport { defineQueryOptions, useQuery } from \"@pinia/colada\";\nimport { IdentityItemsAPI } from \"~/services/identityItems\";\n\nexport const IDENTITY_ITEMS_QUERY_KEY = {\n  root: [\"identityItems\"] as const,\n  list: (filters: IRequestPaginatedOptions) =>\n    [...IDENTITY_ITEMS_QUERY_KEY.root, \"list\", {\n      page: filters.page,\n      pageSize: filters.pageSize,\n      sort: filters.sort,\n      order: filters.order,\n      archived: filters.archived,\n    }] as const,\n  byId: (id: string) =>\n    [...IDENTITY_ITEMS_QUERY_KEY.root, \"byId\", id] as const,\n};\n\nexport const identityItemsQueryOptions = defineQueryOptions(\n  (filters: IRequestPaginatedOptions) => ({\n    key: IDENTITY_ITEMS_QUERY_KEY.list(filters),\n    query: () => IdentityItemsAPI.load(filters),\n    staleTime: 1000 * 60 * 15, // 15 minutes\n  }),\n);\n\nexport const identityItemByIdQueryOptions = defineQueryOptions(\n  (id: string) => ({\n    key: IDENTITY_ITEMS_QUERY_KEY.byId(id),\n    query: () => IdentityItemsAPI.loadById(id),\n    staleTime: 1000 * 60 * 15, // 15 minutes\n  }),\n);\n\nexport function useIdentityItems(filters: Ref<IRequestPaginatedOptions> | (() => IRequestPaginatedOptions)) {\n  return useQuery(identityItemsQueryOptions, filters);\n}\n\nexport function useIdentityItemById(id: Ref<string> | (() => string)) {\n  return useQuery(identityItemByIdQueryOptions, id);\n}\n","<script setup lang=\"ts\">\nimport useAsync from \"~/composables/use-async\";\nimport useFollow from \"~/composables/use-follow\";\nimport useSSOLogin from \"~/composables/use-sso-login\";\nimport { useIdentityItemById } from \"~/queries/identityItems\";\nimport EventsAPI from \"~/services/events\";\nimport useUserStore from \"~/stores/user\";\n\nconst { t } = useI18n();\nconst route = useRoute();\nconst router = useRouter();\nconst userStore = useUserStore();\nconst { executeSocialLogin, socialLoginLoading } = useSSOLogin();\nconst appConfig = useRuntimeConfig().public;\n\nconst isMobile = useIsMobile();\n\nconst isGameHighlightsEnabled = appConfig.APP_CUSTOMER.enable_game_highlights;\nconst isLoggedIn = computed(() => Boolean(userStore.user));\nconst subCategoryId = computed(() => route.params.subId as string);\nconst mainCategoryId = computed(() => route.params.mainId as string);\nconst eventParams = { count: true, pageSize: 20, subCategoryId: subCategoryId.value, mainCategoryId: mainCategoryId.value };\n\nconst { loading: isFollowingDisabled, isFollowing, toggleFollow } = useFollow({ id: subCategoryId.value, type: \"identity_item\" });\nconst { data: live, loading: loadingLive, run: loadLive } = useAsync(() => EventsAPI.load({ ...eventParams, type: \"live\" }));\nconst { data: upcoming, loading: loadingUpcoming, run: loadUpcoming } = useAsync(() => EventsAPI.load({ ...eventParams, type: \"upcoming\" }));\nconst { data: archived, loading: loadingArchived, run: loadArchived } = useAsync(() => EventsAPI.load({ ...eventParams, type: \"archived\" }));\n\nconst { data: identityItem, isLoading: loading } = useIdentityItemById(subCategoryId);\n\nconst banners = computed(() => {\n  if (isMobile.value && identityItem.value?.mobileBanners && identityItem.value.mobileBanners.length > 0) {\n    return identityItem.value.mobileBanners;\n  }\n\n  return identityItem.value?.banners;\n});\n\nconst noContent = computed(() => {\n  const liveCount = live.value?.content?.count || 0;\n  const upcomingCount = upcoming.value?.content?.count || 0;\n  const archivedCount = archived.value?.content?.count || 0;\n\n  return liveCount + upcomingCount + archivedCount === 0;\n});\n\nasync function onClickFollow(item: IModelIdentityItem) {\n  if (!isLoggedIn.value) {\n    if (appConfig.APP_FLAGS.hasIfaAuth && appConfig.APP_CUSTOMER.app_config.enable_skip_login_page_for_ifa_sso)\n      return executeSocialLogin(\"ifa\");\n    return router.push({ path: \"/auth/login/\", query: { redirectUrl: route.fullPath } });\n  }\n\n  return toggleFollow(item);\n}\n\nonMounted(async () => {\n  await Promise.all([\n    loadArchived(),\n    loadLive(),\n    loadUpcoming(),\n  ]);\n});\n\ndefinePageMeta({ layout: \"home\" });\n</script>\n\n<template>\n  <div>\n    <div>\n      <BlockIdentitySkeleton v-if=\"loading\" has-following-button />\n\n      <BlockIdentity\n        v-else-if=\"identityItem\"\n        has-following-button\n        has-events-number\n        :live-events-number=\"live?.content.count ?? 0\"\n        :upcoming-events-number=\"upcoming?.content.count ?? 0\"\n        :total-events-number=\"archived?.content.count ?? 0\"\n        :facebook-url=\"identityItem.facebookUrl\"\n        :x-url=\"identityItem.xUrl\"\n        :instagram-url=\"identityItem.instagramUrl\"\n        :web-url=\"identityItem.webUrl\"\n        :logo-url=\"identityItem.logoUrl\"\n        :banners=\"banners\"\n        :title=\"identityItem.title\"\n        :is-following=\"isFollowing\"\n        :is-following-disabled=\"isFollowingDisabled || socialLoginLoading\"\n        @follow=\"onClickFollow(identityItem as IModelIdentityItem)\"\n      />\n    </div>\n    <div class=\"text-2xl main-container text-main\">\n      <ListEvents\n        :title=\"t('labels.live')\"\n        :items=\"live?.content.entries ?? []\"\n        :loading=\"loadingLive\"\n        :sub-category-id=\"subCategoryId\"\n        :main-category-id=\"mainCategoryId\"\n        type=\"live\"\n        hide-on-no-content\n        has-see-all-link\n        see-all-link-placement=\"top-right\"\n      >\n        <template #end>\n          <div class=\"my-12 hr\" role=\"separator\" />\n        </template>\n      </ListEvents>\n\n      <ListEvents\n        :title=\"t('labels.upcoming')\"\n        :items=\"upcoming?.content.entries ?? []\"\n        :loading=\"loadingUpcoming\"\n        :sub-category-id=\"subCategoryId\"\n        :main-category-id=\"mainCategoryId\"\n        type=\"upcoming\"\n        hide-on-no-content\n        has-see-all-link\n        see-all-link-placement=\"top-right\"\n      >\n        <template #end>\n          <div class=\"my-12 hr\" role=\"separator\" />\n        </template>\n      </ListEvents>\n\n      <ListEvents\n        v-if=\"isGameHighlightsEnabled\"\n        :title=\"t('labels.latest_highlights')\"\n        :sub-category-id=\"subCategoryId\"\n        :main-category-id=\"mainCategoryId\"\n        type=\"highlight\"\n        hide-on-no-content\n        has-see-all-link\n      >\n        <template #end>\n          <div class=\"my-12 hr\" role=\"separator\" />\n        </template>\n      </ListEvents>\n\n      <ListEvents\n        :title=\"t('labels.latest')\"\n        :loading=\"loadingArchived\"\n        :items=\"archived?.content?.entries ?? []\"\n        :sub-category-id=\"subCategoryId\"\n        :main-category-id=\"mainCategoryId\"\n        hide-on-no-content\n        has-see-all-link\n      />\n    </div>\n  </div>\n\n  <BaseNotFound v-if=\"noContent && !loading\" :text=\"t('labels.empty_events_list')\">\n    <template #icon=\"{ isDarkTheme }\">\n      <IconEventNotfound :is-dark-theme=\"isDarkTheme\" />\n    </template>\n  </BaseNotFound>\n</template>\n"],"names":["IdentityItemsAPI","options","request","useRequest","params","formatRequestOptions","response","formatPaginatedResponseItems","formatIdentityItem","subCategoryId","res","IDENTITY_ITEMS_QUERY_KEY","filters","id","identityItemByIdQueryOptions","defineQueryOptions","useIdentityItemById","useQuery","t","useI18n","route","useRoute","router","useRouter","userStore","useUserStore","executeSocialLogin","socialLoginLoading","useSSOLogin","appConfig","useRuntimeConfig","isMobile","useIsMobile","isGameHighlightsEnabled","isLoggedIn","computed","mainCategoryId","eventParams","isFollowingDisabled","isFollowing","toggleFollow","useFollow","live","loadingLive","loadLive","useAsync","EventsAPI","upcoming","loadingUpcoming","loadUpcoming","archived","loadingArchived","loadArchived","identityItem","loading","banners","noContent","liveCount","upcomingCount","archivedCount","onClickFollow","item","onMounted","_createElementVNode","_unref","_createBlock","_component_BlockIdentitySkeleton","_component_BlockIdentity","_cache","$event","_hoisted_1","_createVNode","_component_ListEvents","_component_BaseNotFound","_withCtx","isDarkTheme","_component_IconEventNotfound"],"mappings":"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"}