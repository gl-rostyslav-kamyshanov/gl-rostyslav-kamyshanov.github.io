{"version":3,"file":"BzRP5lgI.js","sources":["../../../../app/pages/auth/login/limit.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport useAsync from \"~/composables/use-async\";\nimport DeviceAPI from \"~/services/device\";\nimport useUserStore from \"~/stores/user\";\nimport { base64ToString } from \"~/utils/base64\";\nimport formatDate from \"~/utils/format-date\";\nimport getErrorLocalePathMessage from \"~/utils/locale\";\n\nconst { t, locale, te } = useI18n();\nconst token = ref(\"\");\nconst route = useRoute();\nconst router = useRouter();\nconst toaster = useToast();\nconst userStore = useUserStore();\nconst appConfig = useRuntimeConfig().public;\nconst hasIfaAuth = appConfig.APP_FLAGS.hasIfaAuth;\nconst getFormattedDate = (date: Date): string => formatDate(date, \"PPPP\", locale.value as TAvailableLocale);\nconst onSuccess = () =>\n  router.push({ path: \"/auth/login/\", query: route.query });\nconst onError = (error: Error) => {\n  const { message } = getErrorLocalePathMessage(error.message, { t, te });\n  return toaster.error(message);\n};\n\nconst {\n  loading,\n  run: deleteDeviceById,\n} = useAsync(DeviceAPI.delete, { onSuccess, onError });\nconst onDeleteDevice = (device: IModelDevice) =>\n  deleteDeviceById(device.id, token.value);\n\nfunction loadParamsFromQuery() {\n  try {\n    const data = JSON.parse(base64ToString(route.query.data as string));\n\n    token.value = data.token;\n  }\n  catch (e) {\n    console.error(e);\n  }\n}\n\nonMounted(() => loadParamsFromQuery());\n\nuseHead({ title: t(\"pages.auth_login_limit.device_limit_reached\") });\n</script>\n\n<template>\n  <div>\n    <AuthHeader :mode=\"hasIfaAuth ? undefined : 'sign-up'\" absolute transparent />\n\n    <BaseMain>\n      <div class=\"pt-32 pb-12 form-column\">\n        <div class=\"w-full max-w-[500px]\">\n          <h1 class=\"text-heading-1-bold\">\n            {{ t(\"pages.auth_login_limit.device_limit_reached\") }}\n          </h1>\n          <p class=\"mt-4 text-xs text-secondary\">\n            {{ t(\"pages.auth_login_limit.remove_device_to_login\") }}\n          </p>\n\n          <div class=\"mt-8\">\n            <CardDevice\n              v-for=\"device in userStore.devices\"\n              :key=\"device.id\"\n              class=\"mb-4\"\n              :title=\"device.deviceName\"\n              :type=\"device.deviceType\"\n              :active=\"device.isCurrent\"\n              :date=\"getFormattedDate(device.addedAt)\"\n              :disabled=\"loading\"\n              @delete=\"onDeleteDevice(device)\"\n            />\n          </div>\n        </div>\n      </div>\n    </BaseMain>\n  </div>\n</template>\n"],"names":["t","locale","te","useI18n","token","ref","route","useRoute","router","useRouter","toaster","useToast","userStore","useUserStore","hasIfaAuth","useRuntimeConfig","getFormattedDate","date","formatDate","onSuccess","onError","error","message","getErrorLocalePathMessage","loading","deleteDeviceById","useAsync","DeviceAPI","onDeleteDevice","device","loadParamsFromQuery","data","base64ToString","e","onMounted","useHead","_createElementBlock","_createVNode","_component_AuthHeader","_unref","_component_BaseMain","_createElementVNode","_hoisted_1","_hoisted_2","_hoisted_3","_toDisplayString","_hoisted_4","_hoisted_5","_openBlock","_Fragment","_renderList","_createBlock","_component_CardDevice","$event"],"mappings":"86BAQA,KAAM,CAAE,EAAAA,EAAG,OAAAC,EAAQ,GAAAC,CAAA,EAAOC,EAAA,EACpBC,EAAQC,EAAI,EAAE,EACdC,EAAQC,EAAA,EACRC,EAASC,EAAA,EACTC,EAAUC,EAAA,EACVC,EAAYC,EAAA,EAEZC,EADYC,IAAmB,OACR,UAAU,WACjCC,EAAoBC,GAAuBC,EAAWD,EAAM,OAAQhB,EAAO,KAAyB,EACpGkB,EAAY,IAChBX,EAAO,KAAK,CAAE,KAAM,eAAgB,MAAOF,EAAM,MAAO,EACpDc,EAAWC,GAAiB,CAChC,KAAM,CAAE,QAAAC,GAAYC,EAA0BF,EAAM,QAAS,CAAE,EAAArB,EAAG,GAAAE,EAAI,EACtE,OAAOQ,EAAQ,MAAMY,CAAO,CAC9B,EAEM,CACJ,QAAAE,EACA,IAAKC,CAAA,EACHC,EAASC,EAAU,OAAQ,CAAE,UAAAR,EAAW,QAAAC,EAAS,EAC/CQ,EAAkBC,GACtBJ,EAAiBI,EAAO,GAAIzB,EAAM,KAAK,EAEzC,SAAS0B,GAAsB,CAC7B,GAAI,CACF,MAAMC,EAAO,KAAK,MAAMC,EAAe1B,EAAM,MAAM,IAAc,CAAC,EAElEF,EAAM,MAAQ2B,EAAK,KACrB,OACOE,EAAG,CACR,QAAQ,MAAMA,CAAC,CACjB,CACF,CAEA,OAAAC,EAAU,IAAMJ,GAAqB,EAErCK,EAAQ,CAAE,MAAOnC,EAAE,6CAA6C,EAAG,uCAIjEoC,EA6BM,MAAA,KAAA,CA5BJC,EAA8EC,EAAA,CAAjE,KAAMC,EAAAzB,CAAA,EAAa,OAAS,UAAc,SAAA,GAAS,YAAA,EAAA,mBAEhEuB,EAyBWG,EAAA,KAAA,WAxBT,IAuBM,CAvBNC,EAuBM,MAvBNC,EAuBM,CAtBJD,EAqBM,MArBNE,EAqBM,CApBJF,EAEK,KAFLG,EAEKC,EADAN,EAAAvC,CAAA,EAAC,6CAAA,CAAA,EAAA,CAAA,EAENyC,EAEI,IAFJK,EAEID,EADCN,EAAAvC,CAAA,EAAC,+CAAA,CAAA,EAAA,CAAA,EAGNyC,EAYM,MAZNM,GAYM,EAXJC,EAAA,EAAA,EAAAZ,EAUEa,EAAA,KAAAC,EATiBX,EAAA3B,CAAA,EAAU,QAApBiB,QADTsB,EAUEC,EAAA,CARC,IAAKvB,EAAO,GACb,MAAM,OACL,MAAOA,EAAO,WACd,KAAMA,EAAO,WACb,OAAQA,EAAO,UACf,KAAMb,EAAiBa,EAAO,OAAO,EACrC,SAAUU,EAAAf,CAAA,EACV,SAAM6B,IAAEzB,EAAeC,CAAM,CAAA"}