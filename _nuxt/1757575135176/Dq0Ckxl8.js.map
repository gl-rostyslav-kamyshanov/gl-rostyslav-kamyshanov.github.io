{"version":3,"file":"Dq0Ckxl8.js","sources":["../../../../app/services/club.ts","../../../../app/components/Base/ClubSelector.vue"],"sourcesContent":["import useRequest from \"~/composables/use-request\";\nimport useUserStore from \"~/stores/user\";\nimport { formatClubList, formatRequestOptions, getFavoriteClubIdFromList, returnPaginatedResponse } from \"./format\";\n\nconst ClubsAPI = {\n  load(options?: IRequestPaginatedOptions): Promise<IPaginatedResponse<IModelFavoriteClub>> {\n    const { request } = useRequest();\n    const params = formatRequestOptions(options);\n\n    return request\n      .post<IPaginatedResponse<IResponseÐ¡lubList>>(\"/api/identity/club_list\", { body: params })\n      .then(response => returnPaginatedResponse(formatClubList(response.content.entries)));\n  },\n  save(id: string): Promise<void> {\n    const { request } = useRequest();\n    const userStore = useUserStore();\n\n    const [identity, identityItem] = id.split(\"|\");\n\n    return request\n      .post<IContentResponse<IResponseProfile>>(\"/api/user/add_to_club_list\", { body: { identity, identityItem } })\n      .then((response) => {\n        if (userStore.user && !userStore.user.favoriteClubId)\n          userStore.user.favoriteClubId = getFavoriteClubIdFromList(response.content.clubList);\n      });\n  },\n};\n\nexport default ClubsAPI;\n","<script setup lang=\"ts\">\nimport usePagination from \"~/composables/use-pagination\";\nimport { ORDER, SORT } from \"~/constants\";\nimport ClubsAPI from \"~/services/club\";\n\nexport interface ClubSelectorProps {\n  required?: boolean;\n  disabled?: boolean;\n  modelValue?: string;\n}\n\nconst props = withDefaults(defineProps<ClubSelectorProps>(), {\n  required: false,\n});\nconst emit = defineEmits([\"update:modelValue\"]);\n\nconst { t } = useI18n();\nconst clubId = useVModel(props, \"modelValue\", emit);\n\nconst { items: clubs, loading: loadingClubs } = usePagination<IModelFavoriteClub>({\n  immediate: true,\n  loadItemsFn: () => ClubsAPI.load({ pageSize: 500, order: ORDER.asc, sort: SORT.order }),\n});\n\nconst favoriteClubCategoryTitle = computed(() => clubs.value.find(club => club.id === clubId.value)?.categoryTitle);\n</script>\n\n<template>\n  <BaseSelect\n    v-model=\"clubId\"\n    :placeholder=\"t('labels.select_your_club')\"\n    :has-option-title=\"false\"\n    :disabled=\"props.disabled || loadingClubs\"\n    :options=\"clubs\"\n    :readonly=\"false\"\n    :required=\"props.required\"\n    emitted-key=\"id\"\n    name=\"favorite-club\"\n    options-key-title=\"label\"\n    options-key-value=\"title\"\n    has-search\n  >\n    <template #innerInput=\"{ value, toggle }\">\n      <div v-if=\"value\" class=\"w-full cursor-pointer\" @click=\"toggle\">\n        <p class=\"text-main line-clamp-2\">\n          {{ value }}\n        </p>\n        <p class=\"text-xs text-[var(--base-secondary-color)]\">\n          {{ favoriteClubCategoryTitle }}\n        </p>\n      </div>\n    </template>\n\n    <template #option-item-inner-prefix=\"{ option }\">\n      <div class=\"flex flex-col max-w-[21rem]\">\n        <p class=\"line-clamp-2\">\n          {{ (option as IModelFavoriteClub).label }}\n        </p>\n        <p class=\"text-[11px] text-[var(--base-secondary-color)]\">\n          {{ (option as IModelFavoriteClub).categoryTitle }}\n        </p>\n      </div>\n    </template>\n  </BaseSelect>\n</template>\n\n<style lang=\"scss\" scoped>\n:deep(.baseSelect__listOption) {\n  @apply px-4 py-3;\n}\n\n:deep(.baseInput__field_hasContent) {\n  @apply px-4 py-1\n}\n</style>\n"],"names":["ClubsAPI","options","request","useRequest","params","formatRequestOptions","response","returnPaginatedResponse","formatClubList","id","userStore","useUserStore","identity","identityItem","getFavoriteClubIdFromList","props","__props","emit","__emit","t","useI18n","clubId","useVModel","clubs","loadingClubs","usePagination","ORDER","SORT","favoriteClubCategoryTitle","computed","club","_createBlock","_component_BaseSelect","_unref","$event","_withCtx","value","toggle","_createElementBlock","_createElementVNode","_hoisted_2","_toDisplayString","_hoisted_3","option","_hoisted_4","_hoisted_5","_hoisted_6"],"mappings":"8PAIA,MAAMA,EAAW,CACf,KAAKC,EAAqF,CACxF,KAAM,CAAE,QAAAC,CAAA,EAAYC,EAAA,EACdC,EAASC,EAAqBJ,CAAO,EAE3C,OAAOC,EACJ,KAA4C,0BAA2B,CAAE,KAAME,EAAQ,EACvF,KAAKE,GAAYC,EAAwBC,EAAeF,EAAS,QAAQ,OAAO,CAAC,CAAC,CACvF,EACA,KAAKG,EAA2B,CAC9B,KAAM,CAAE,QAAAP,CAAA,EAAYC,EAAA,EACdO,EAAYC,EAAA,EAEZ,CAACC,EAAUC,CAAY,EAAIJ,EAAG,MAAM,GAAG,EAE7C,OAAOP,EACJ,KAAyC,6BAA8B,CAAE,KAAM,CAAE,SAAAU,EAAU,aAAAC,EAAa,CAAG,EAC3G,KAAMP,GAAa,CACdI,EAAU,MAAQ,CAACA,EAAU,KAAK,iBACpCA,EAAU,KAAK,eAAiBI,EAA0BR,EAAS,QAAQ,QAAQ,EACvF,CAAC,CACL,CACF,gYCfA,MAAMS,EAAQC,EAGRC,EAAOC,EAEP,CAAE,EAAAC,CAAA,EAAMC,EAAA,EACRC,EAASC,EAAUP,EAAO,aAAcE,CAAI,EAE5C,CAAE,MAAOM,EAAO,QAASC,CAAA,EAAiBC,EAAkC,CAChF,UAAW,GACX,YAAa,IAAMzB,EAAS,KAAK,CAAE,SAAU,IAAK,MAAO0B,EAAM,IAAK,KAAMC,EAAK,MAAO,CAAA,CACvF,EAEKC,EAA4BC,EAAS,IAAMN,EAAM,MAAM,KAAKO,GAAQA,EAAK,KAAOT,EAAO,KAAK,GAAG,aAAa,qCAIhHU,EAmCaC,EAAA,YAlCFC,EAAAZ,CAAA,4CAAAA,EAAM,MAAAa,EAAA,MACd,YAAaD,EAAAd,CAAA,EAAC,yBAAA,EACd,mBAAkB,GAClB,SAAUJ,EAAM,UAAYkB,EAAAT,CAAA,EAC5B,QAASS,EAAAV,CAAA,EACT,SAAU,GACV,SAAUR,EAAM,SACjB,cAAY,KACZ,KAAK,gBACL,oBAAkB,QAClB,oBAAkB,QAClB,aAAA,EAAA,GAEW,WAAUoB,EACnB,CAOM,CARiB,MAAAC,EAAO,OAAAC,KAAM,CACzBD,OAAXE,EAOM,MAAA,OAPY,MAAM,wBAAyB,QAAOD,CAAA,GACtDE,EAEI,IAFJC,EAEIC,EADCL,CAAK,EAAA,CAAA,EAEVG,EAEI,IAFJG,EAEID,EADCR,EAAAL,CAAA,CAAyB,EAAA,CAAA,CAAA,mBAKvB,2BAAwBO,EACjC,CAOM,CAR+B,OAAAQ,KAAM,CAC3CJ,EAOM,MAPNK,EAOM,CANJL,EAEI,IAFJM,EAEIJ,EADEE,EAA8B,KAAK,EAAA,CAAA,EAEzCJ,EAEI,IAFJO,EAEIL,EADEE,EAA8B,aAAa,EAAA,CAAA,CAAA"}