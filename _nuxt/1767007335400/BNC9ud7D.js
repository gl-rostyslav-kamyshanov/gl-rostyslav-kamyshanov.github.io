import{u as B,a as N,b as U,_ as P,d as k,g as C}from"./vfF7RKPo.js";import{_ as I}from"./DowbGgKV.js";import{_ as $,a as A,v as l}from"./V8NEB3vv.js";import{P as D}from"./Co_HdXxg.js";import{d as E,B as F,N as J,c as O,o as T,b as d,h as G,f as t,Y as e,ad as m,v as c}from"./DrHYGv5w.js";import"./IVvJIK5b.js";import"./Dql7-ge0.js";import"./B1IlCmgd.js";import"./Dq-QN952.js";import"./B47pBCHT.js";import"./B-DBQphj.js";const L={class:"flex flex-col gap-6"},se=E({__name:"password",setup(M){const{t:s,te:f}=B(),i=k(),b=N(),a=F({password_old:"",password_new:"",password_new_repeat:""});function g(n){const o=[],r=e(n);return l.required(r.password_old)?l.min(r.password_old,{length:8})||o.push({path:"password_old",message:s("errors.invalid_password")}):o.push({path:"password_old",message:s("errors.field_is_required")}),l.required(r.password_new)?l.min(r.password_new,{length:8})||o.push({path:"password_new",message:s("errors.invalid_password")}):o.push({path:"password_new",message:s("errors.field_is_required")}),l.required(r.password_new_repeat)?l.min(r.password_new_repeat,{length:8})||o.push({path:"password_new_repeat",message:s("errors.invalid_password")}):o.push({path:"password_new_repeat",message:s("errors.field_is_required")}),o}const h=JSON.stringify(a),v=J(()=>JSON.stringify(a)!==h),x=()=>(a.password_new="",a.password_new_repeat="",a.password_old="",i.success(s("pages.account_password.alert_password_update_success"))),V=n=>{const{message:o}=C(n.message,{t:s,te:f});return i.error(o)},{loading:p,run:q}=U(D.change,{onSuccess:x,onError:V});async function S(){if(a.password_new!==a.password_new_repeat){i.error(s("errors.passwords_dont_match"));return}const n={current_password:a.password_old,new_password:a.password_new};return q(n)}return(n,o)=>{const r=P,w=I,u=$,y=A;return T(),O(y,{state:e(a),validate:g,onSubmit:S},{default:d(()=>[G("div",L,[t(u,{label:e(s)("labels.password_old"),name:"password_old",required:""},{default:d(()=>[t(w,{modelValue:e(a).password_old,"onUpdate:modelValue":o[0]||(o[0]=_=>e(a).password_old=_),disabled:e(p),name:"password",placeholder:e(s)("labels.enter_old_password"),autocomplete:"new-password",sensitive:""},{"label-suffix":d(()=>[t(r,{name:"forgot-password",class:"text-caption-medium",tag:"nuxt-link",to:{path:"/auth/password/forgot/",query:{email:e(b).user?.email}},disabled:e(p),link:""},{default:d(()=>[m(c(e(s)("labels.forgot_password"))+"? ",1)]),_:1},8,["to","disabled"])]),_:1},8,["modelValue","disabled","placeholder"])]),_:1},8,["label"]),t(u,{label:e(s)("labels.password_new"),name:"password_new",required:""},{default:d(()=>[t(w,{modelValue:e(a).password_new,"onUpdate:modelValue":o[1]||(o[1]=_=>e(a).password_new=_),disabled:e(p),placeholder:e(s)("labels.enter_new_password"),name:"new-password",autocomplete:"new-password",sensitive:""},null,8,["modelValue","disabled","placeholder"])]),_:1},8,["label"]),t(u,{label:e(s)("labels.password_repeat"),name:"password_new_repeat",required:""},{default:d(()=>[t(w,{modelValue:e(a).password_new_repeat,"onUpdate:modelValue":o[2]||(o[2]=_=>e(a).password_new_repeat=_),disabled:e(p),placeholder:e(s)("labels.confirm_new_password"),name:"new-password-confirm",autocomplete:"new-password",sensitive:""},null,8,["modelValue","disabled","placeholder"])]),_:1},8,["label"])]),t(r,{class:"mt-10 font-bold",name:"submit-password",disabled:e(p)||!e(v),"full-width":""},{default:d(()=>[m(c(e(s)("labels.save")),1)]),_:1},8,["disabled"])]),_:1},8,["state"])}}});export{se as default};
