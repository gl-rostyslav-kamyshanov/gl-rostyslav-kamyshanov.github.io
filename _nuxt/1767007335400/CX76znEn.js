import{_ as z,a as L}from"./CZgr-xsV.js";import{d as B,g as x,o as m,$ as F,s as v,X as H,R as D,f as h,b as R,h as n,i as T,c as K,Y as r,v as y,ad as X,F as Y}from"./DrHYGv5w.js";import{aZ as I,u as Z,k as G,l as J,a_ as Q,i as W,b as E,aw as g,_ as tt}from"./vfF7RKPo.js";import{B as U}from"./mCVtpy1_.js";import"./YXvYJOkl.js";import"./qTb77THm.js";import"./6tYJEWcP.js";import"./B4wo3SUq.js";import"./DJO5Ko8d.js";import"./d1rVCiWV.js";import"./Dql7-ge0.js";import"./xeMFU3jQ.js";import"./B-DBQphj.js";import"./CeLpXuE_.js";import"./B47pBCHT.js";import"./DsilW_8g.js";import"./CuVeKCNu.js";import"./DowbGgKV.js";import"./B1IlCmgd.js";import"./Dq-QN952.js";import"./DjtFQFjx.js";import"./DdW31oNs.js";import"./CFdcWqxl.js";import"./BmvnMvdl.js";import"./DNaFeO-P.js";import"./IVvJIK5b.js";import"./BW4JKS41.js";import"./C_PxQ261.js";const et=["width","height"],ot=B({__name:"Blade2",props:{size:{default:40}},setup(i){const t=i;return(s,a)=>(m(),x("svg",{xmlns:"http://www.w3.org/2000/svg",width:t.size,height:t.size,viewBox:"0 0 24 24"},[...a[0]||(a[0]=[F('<g><rect width="2" height="5" x="11" y="1" fill="currentColor" opacity=".14"></rect><rect width="2" height="5" x="11" y="1" fill="currentColor" opacity=".29" transform="rotate(30 12 12)"></rect><rect width="2" height="5" x="11" y="1" fill="currentColor" opacity=".43" transform="rotate(60 12 12)"></rect><rect width="2" height="5" x="11" y="1" fill="currentColor" opacity=".57" transform="rotate(90 12 12)"></rect><rect width="2" height="5" x="11" y="1" fill="currentColor" opacity=".71" transform="rotate(120 12 12)"></rect><rect width="2" height="5" x="11" y="1" fill="currentColor" opacity=".86" transform="rotate(150 12 12)"></rect><rect width="2" height="5" x="11" y="1" fill="currentColor" transform="rotate(180 12 12)"></rect><animateTransform attributeName="transform" calcMode="discrete" dur="0.75s" repeatCount="indefinite" type="rotate" values="0 12 12;30 12 12;60 12 12;90 12 12;120 12 12;150 12 12;180 12 12;210 12 12;240 12 12;270 12 12;300 12 12;330 12 12;360 12 12"></animateTransform></g>',1)])],8,et))}}),rt=Object.assign(ot,{__name:"IconSpinnerBlade2"});function nt(i,t){i&&i.on(I.USER_PURCHASE_STATUS,({status:s})=>{s==="APPROVED"?t?.onSuccess?.():t?.onError?.(new Error("Payment Failed!"))})}const st={class:"flex px-4 items-center justify-center flex-col h-full"},it={class:"w-full max-w-[400px]"},at={class:"flex flex-col justify-center items-center"},ct={class:"flex flex-col justify-center items-center gap-6"},lt={key:0,class:"flex justify-center items-center size-16 bg-[var(--base-card-bgColor)] rounded-full"},ut={class:"flex flex-col justify-center items-center gap-4"},mt={class:"text-3xl font-bold"},_t={class:"text-center text-[var(--base-secondary-color)] font-medium"},zt=B({__name:"processing",setup(i){const{t}=Z(),s=G(),a=J(),w=Q(),l=W().public,A=!l.APP_CUSTOMER.enable_async_payment_flow,k=Math.abs(l.APP_CUSTOMER.payment_timeout)*1e3,u=l.APP_CUSTOMER.success_payment_redirect_url,S=l.APP_CUSTOMER.subscription_id,o=s.query.productId,_=s.query.redirectURL,M=s.query.title,p=u&&S===o,f=v(!0),d=v(null),{run:P}=E(U.verifyTransaction,{onSuccess:b,onError:C}),{run:O}=E(U.confirmProcessingPayment);function b(){if(o&&g.remove(`transactionId_${o}`),p){const e=new URL(u);return window.location.href=e.toString()}if(f.value=!1,u&&S===o){const e=new URL(u);return window.location.href=e.toString()}a.push({path:"/payment/success/",query:{title:M,productId:o,redirectURL:_}})}function C(){o&&g.remove(`transactionId_${o}`),f.value=!1,a.push({path:"/payment/failure/",query:{productId:o,redirectURL:_}})}async function N(){const e=g.get(`transactionId_${o}`);if(A)return P(e);e&&await O(e),await Promise.race([new Promise(c=>{nt(w,{onSuccess:()=>{b(),c()},onError:()=>{C(),c()}})}),new Promise(c=>{d.value=setTimeout(c,k)})]),e&&P(e)}return H(N),D(()=>{w?.off(I.USER_PURCHASE_STATUS),d.value&&clearTimeout(d.value)}),(e,c)=>{const V=z,j=rt,$=tt,q=L;return m(),x(Y,null,[h(V,{transparent:"",absolute:""}),h(q,{class:"!h-[calc(100%-25px)]"},{default:R(()=>[n("div",st,[n("div",it,[n("div",at,[n("div",ct,[r(f)?(m(),x("div",lt,[h(j,{size:24})])):T("",!0),n("div",ut,[n("h1",mt,y(r(t)("pages.account_billing.payment_in_progress")),1),n("p",_t,y(r(p)?r(t)("pages.account_billing.payment_in_progress_message_2"):r(t)("pages.account_billing.payment_in_progress_message")),1)]),r(p)?T("",!0):(m(),K($,{key:1,name:"subscribe",type:"primary",class:"font-bold",tag:"nuxt-link",to:{path:r(_)||"/"}},{default:R(()=>[X(y(r(t)("labels.back_to_site")),1)]),_:1},8,["to"]))])])])])]),_:1})],64)}}});export{zt as default};
